---
title: "Bellbeat Case Study with R"
author: "Alemu Tesfaye"
date: '`r Sys.Date()`'
output:
  html_document:
    number_sections: true
    toc: true
---


# STEP 1: Ask
## Introduction and background
Bellabeat is a high-tech manufacturer of health-focused smart products for women founded in 2013. In 2016, Bellabeat had opened offices around the world and launched multiple products. Bellabeat products became available through a growing number of online retailers in addition to their own e-commerce channel on their website. Its smart products has allowed it to empower women with knowledge about their own health and habits. The company has grown rapidly and quickly positioned itself as a tech-driven wellness company for women. Urška Sršen, cofounder and Chief Creative Officer of Bellabeat, believes that analyzing non-Bellabeat (FitBit fitness tracker usage data) smart device fitness usage data could help unlock new growth opportunities for the company. 

## Business Task
Analyze FitBit fitness tracker usage data to gain insight into how consumers are using it and identify trends that can guide the marketing strategy of Bellabeat.

## Objectives
* Identify trends how consumers are using non Bellabeat smart devices
* Identify how these trends can be applied to the customers of one of Bellabeat’s  (Bellabeat app) smart devices
* Provide high-level recommendations for how the trends identified can inform the marketing strategy of the company

## Key Stakeholders
* Urška Sršen: Bellabeat’s cofounder and Chief Creative Officer
* Sando Mur: Mathematician and Bellabeat’s cofounder; key member of the Bellabeat executive team
* Bellabeat marketing analytics team: A team of data analysts responsible for collecting, analyzing, and reporting data that helps guide Bellabeat’s marketing strategy. 

## Deliverable 
* A clear summary of the business task 
* A description of all data sources used 
* Documentation of any cleaning or manipulation of data 
* A summary of the analysis 
* Supporting visualizations and key findings 
* The top high-level content recommendations based on the analysis

# STEP 2: PREPARE
## About the Data 
The data is publicly available on Kaggle (FitBit Ftness Tracker Data) which is made available by Mobius. The data is organized in 18 csv files. The dataset is generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. The data has been updated on Dec 16, 2020 and all the data is organized in a long data format. 
The data has some limitations. First, a sample size of 30 FitBit users is not representative of the whole fitness population and second, since the data is collected through an online distributed survey, it is difficult to determine its integrity and accuracy. In addition to that there is no information on key demographic data such as gender, age etc… 

### Access, License
The data has been dedicated to the public domain and has no copyright it has no licensing or access issues. Consent has been secured from the users addressing issues related to privacy. 

## ROCCC
When I scrutinized the data source further for ROCCC (Reliable, Original, Comprehensive, Current and Cited), I have found out the data quality to be as follows based on a scale of Low, Medium and High

* Reliable - Low: because the number of respondents are only 30 and doesn’t represent the whole fitness population
* Original - Low: because the data is provided through a third party (Amazon Mechanical Turk)
* Comprehensive - Medium: because it contains critical information needed to answer the question or find the solution and the fields in the table contain most of Bellabeat’s product fields but misses important information regarding gender and age
* Current - High; because the data has been updated a year ago
* Cited - Low: because the data has been collected from consented Fitbit users 

Overall the data has low score of ROCCC. 

I chose data sources from FitBit that contain all important information about the user’s habit on a daily basis and helps me to make recommendations for the Leaf Bellabeat’s product. Leaf is Bellabeat’s classic wellness tracker which can be worn as a bracelet, necklace, or clip. The Leaf tracker connects to the Bellabeat app to track activity, sleep, and stress. Since the Leaf tracks activity, sleep and stress, I have chosen “dailyActivity_merged.csv”, “sleepDay_merged.csv”, “weightLogInfo_merged.csv”, and “dailyIntensities_merged.csv” datasets from FitBit.

# STEP 3: PROCESS
## Tools
Even though the data is small in size and can easily be analyzed using Google Sheets, I have chosen both Google Sheets and R. I have used Sheets during step 2 (Prepare) of the data analysis process and R for the rest of the steps. I wanted to use R for three reasons. The first one is I wanted to use the R Markdown for documentation, the second reason is I wanted to show very appealing visualizations using R and the last is I wanted to experiment more with R before the completion of the Google Data Analytics course.

## Cleaning the Data
I have checked all the data sources for duplicates, empty values, consistency of  formats (mm/dd/yyyy), empty spaces using Google Sheets. Here is a summary table of the data cleaning for each data source:

|     Data Source name               |     Cleaning Process                                             |     Remarks                                                                                                                                                 |
|------------------------------------|------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     dailyActivity_merged.csv       |                                                                  |                                                                                                                                                             |
|                                    |     Checking Empty values using conditional formatting           |     None empty values                                                                                                                                       |
|                                    |     Removing duplicate values                                    |     No duplicates                                                                                                                                           |
|                                    |     Made sure Date format is (mm/dd/yyyy)                        |                                                                                                                                                             |
|                                    |     Made distance two decimal places                             |     Rounded off values of the following fields (TotalDistance,   TrackerDistance, VeryActiveDistance, ModeratelyActiveDistance,   LightActiveDistance, )    |
|     sleepDay_merged.csv            |                                                                  |                                                                                                                                                             |
|                                    |     Checking Empty values using conditional formatting           |     None empty values                                                                                                                                       |
|                                    |     Removing duplicate values                                    |     3 duplicate rows found and removed. 410   unique rows remain.                                                                                           |
|                                    |     Made sure Date/Time format is (mm/dd/yyyy HH:MM:SS AM/PM)    |                                                                                                                                                             |
|     weightLogInfo_merged.csv       |                                                                  |                                                                                                                                                             |
|                                    |     Checking Empty values using conditional formatting           |                                                                                                                                                             |
|                                    |     Removing duplicate values                                    |     No duplicates                                                                                                                                           |
|                                    |     Made sure Date/Time format is (mm/dd/yyyy HH:MM:SS AM/PM)    |                                                                                                                                                             |
|                                    |     Made weight two decimal places                               |     Rounded off values for WeightKg and WeightPounds                                                                                                        |
|     dailyIntensities_merged.csv    |                                                                  |                                                                                                                                                             |
|                                    |     Checking Empty values using conditional formatting           |     No empty values                                                                                                                                         |
|                                    |     Removing duplicate values                                    |     No duplicates                                                                                                                                           |
|                                    |     Made sure Date format is (mm/dd/yyyy)                        |                                                                                                                                                             |
|                                    |     Made distance two decimal places                             |     Rounded off values of three coulmns( lightActiveDistance,   ModeratleyActiveDistance, veryActiveDistance)                                               |
|     heartrate_seconds_merged       |     Checking Empty values using conditional formatting           |     No empty values                                                                                                                                         |
|                                    |                                                                  |                                                                                                                                                             |
|                                    |     Removing duplicate values                                    |     No duplicates                                                                                                                                           |
|                                    |     Made sure Date/Time format is (mm/dd/yyyy HH:MM:SS AM/PM)    |                                                                                                                                                             |


## Filenames
After sorting and filtering the data, I have standardized the file names by subject, date and version accordingly:

* dailyActivity_merged.csv => dailyActivity_merged_2021_12_31_v01.csv
* sleepDay_merged.csv => sleepDay_merged_2021_12_31_v01.csv, 
* weightLogInfo_merged.csv => weightLogInfo_merged_2021_12_31_v01.csv,
* dailyIntensities_merged.csv => dailyIntensities_merged_2021_12_31_v01.csv
* heartrate_sseconds_merged.csv => heartrate_seconds_merged_2021_12_31_v01.csv

# STEP 4: ANALYZE
## Loading packages

The following packages are used in data transformation, analysis and visualization
```{r install_packages}
install.packages("tidyverse")
library(tidyverse)
install.packages("tidyr")
library(tidyr)
install.packages("dplyr")
library(dplyr)
install.packages("ggplot2")
library(ggplot2)
```
## Importing datasets
The five dataframes have been sorted, filtered and cleaned using Google Sheets as shown above in the table. After that I have uploaded the data frames into my work space on R Studio Cloud and imported them using the following R code.
```{r import_datasets}
daily_activity <- read.csv("../input/bellabeat-dataset/dailyActivity_merged_2021_12_31_v01.csv")
daily_intensities <- read.csv("../input/bellabeat-dataset/dailyIntensities_merged_2021_12_31_v01.csv")
sleep_day <- read.csv("../input/bellabeat-dataset/sleepDay_merged_2021_12_31_v01.csv")
weight <- read.csv("../input/bellabeat-dataset/weightLogInfo_merged_2021_12_31_v01.csv")
heart <- read.csv("../input/bellabeat-dataset/heartrate_seconds_merged_2021_12_31_v01.csv")
```
## Explore the tables
Taking a look at the daily_activity data
```{r show_daily_activity}
head(daily_activity)
```
Identify all the columns in the daily_activity data
```{r columns_daily_activity}
colnames(daily_activity)
```
Taking a look at the daily_intensities data
```{r show_daily_intensities}
head(daily_intensities)
```
Identify all the columns in the daily_activity data
```{r columns_daily_intensities}
colnames(daily_intensities)
```
Taking a look at the sleep_day data
```{r show_sleep_day}
head(sleep_day)
```
Identiy all the columns in the sleep_day data
```{r columns_sleep_day}
colnames(sleep_day)
```
Taking a look at the sleep_day data
```{r show_weight}
head(weight)												
```
Identify all the columns in the sleep_day data
```{r columns_weight}
colnames(weight)
```
## Fixing date format
I have fixed the date format of the daily activity and sleep data sets
```{r fix_date_format}
# daily_activity
daily_activity$ActivityDate=as.POSIXct(daily_activity$ActivityDate, format="%m/%d/%Y", tz=Sys.timezone())
daily_activity$date <- format(daily_activity$ActivityDate, format = "%m/%d/%y")
# sleep
sleep_day$SleepDay=as.POSIXct(sleep_day$SleepDay, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
sleep_day$date <- format(sleep_day$SleepDay, format = "%m/%d/%y")
```

## Summary statistics
### Unique participants in each dataframe?
The daily activity dataset has 33 participants, the daily intensities data set has also 33 participants, the daily sleep data set has 24 participants, the weight data set has only 8 participants. Hence, the data sets doesnot have equal number of participants.
```{r summary_stats}
n_distinct(daily_activity$Id)										
n_distinct(daily_intensities$Id)										
n_distinct(sleep_day$Id)										
n_distinct(weight$Id)											
```
### Observations in each dataframe
The daily activity dataset  has 940 observations, the daily intensities data set has 940 observations, the daily sleep data set has 410 observations, the weight data set has 67 observations.
```{r observations}
nrow(daily_activity)										
nrow(daily_intensities)										
nrow(sleep_day)										
nrow(weight)											
```
## Summary statistics about each data frame
### For the daily activity dataframe:
```{r summary_daily_activity}
daily_activity %>%  
  select(TotalSteps,
         TotalDistance,
         SedentaryMinutes
                ) %>%
  summary()
```
#### The summary reveals:
* The average user is taking 7,638 steps a day. 10,000 steps is the recommendation by WHO to achieve the required physical activity level.
* On average participants are sedentary 991.2 minutes, or 16.52 hours a day!Extended periods of sedentary behavior is associated with adverse health risks, even among those who reach recommended levels of physical activity. 

### For the daily intensities dataframe:
```{r summary_intensities}
daily_intensities %>%  
  select(SedentaryMinutes,
         VeryActiveMinutes,
         VeryActiveDistance) %>%
  summary()
```
#### The summary reveals:
* On average participants are sedentary for about close to 17hrs. 
* and very active for only 21 minutes per day


### For the sleep dataframe:
```{r summary_TotalSleepRecords}
sleep_day %>%  
  select(TotalSleepRecords,
  TotalMinutesAsleep,
  TotalTimeInBed,
      ) %>%
  summary()

```
#### The summary reveals:
* on average participants sleep 419.2 minutes per day which is roughly 7 hours. The CDC recommends 7 or more hours per night for adults.
* on average participants spend 39.3 minutes awake in bed. Many doctors agree that it should take between 10 and 20 minutes to fall asleep at bedtime.

### For the weight dataframe:
```{r summary_weight}
weight %>%  
  select(WeightKg,
  BMI) %>%
  summary()
```
#### The summary reveals:
* The average BMI of participants is 25.19. Eventhough height is not available in the data, the recommended BMI range is 18.5 to 24.9

# STEP 5: SHARE
Here are some visualizations to show high-level insights and recommendations
#### Total Steps covered by user
```{r vis_TotalSteps}
options(scipen = 999)
ggplot(data=daily_activity, aes(x=TotalSteps, y=Calories, colour=Id)) + 
  geom_point(show.legend = FALSE) + geom_smooth() + labs(title="Total Steps vs. Calories")
```

As expected and shown in the plot above, there is a direct correlation between total steps and calories burned
### heart rate of participants at various dates and times
```{r vis_heartrates}
    ggplot(data=heart, aes(Value)) + geom_bar()
```

As shown in the plot, the heart rate of most participants during various dates and times lie between 50bpm and 100bpm. There are heart rates which are more than 100, which might need attention. But it is also worth to mension that the data has limitations because it does not indicate during what type of activity the data is collected. 

### Visualize daily activity data
#### Activity type and calories burned
I will first use the daily activity data set to summerize the data by activity type and calories grouped by user and show the relationship between steps and calories; and distance and calories;
```{r vis_daily_activity}
install.packages("cowplot")
library(cowplot)
plot1 <- ggplot(data=daily_activity, aes(x=TotalSteps, y=Calories)) + 
  geom_point() + geom_smooth() + labs(title="Total Steps vs. Calories")
# as expected there is a direct correlation between total steps covered and calories burned 
plot2 <- ggplot(data=daily_activity, aes(x=TotalDistance, y=Calories)) + 
  geom_point() + geom_smooth() + labs(title="Total Distance vs. Calories")
# Similarly there is a direct correlation between total steps covered and calories burned
plot3 <- ggplot(data=daily_activity, aes(x=VeryActiveMinutes, y=Calories)) + 
  geom_point() + geom_smooth() + labs(title="Very Active Minutes vs. Calories")
# there is a strong direct correlation between total steps covered and calories burned
plot4 <- ggplot(data=daily_activity, aes(x=LightlyActiveMinutes, y=Calories)) + 
  geom_point() + geom_smooth() + labs(title="Light Active Minutes vs. Calories")
# as expected light activities does not burn as much calories as the very active minutes ones
plot5 <- ggplot(data=daily_activity, aes(x=FairlyActiveMinutes, y=Calories)) + 
  geom_point() + geom_smooth() + labs(title="Fairly Active Minutes vs. Calories")  
plot_grid(plot1, plot2, plot3, plot4, plot5, ncol=2)
# the same holds true as fairly active minutes does not burn as much calories as the very active minutes ones
```

### Merge Sleep and Daily Activity Datasets
* Here I will merge the daily activity data set and the sleep data sets by Id and date
* and then I will compare the relationship between Total minutes asleep with SedentaryMinutes, VeryActiveMinutes, FairlyActiveMinutes, LightActiveMinutes
* this will give me an insight into the relationship among sleep and activity types.
```{r merge_sleep_activity}

sleep_and_activity <- merge(sleep_day, daily_activity, by=c('Id', 'date'))
head(sleep_and_activity)
```
#### Visualize Sleep vs Activity Type:

```{r vis_sleep_activity}
plot6 <- ggplot(data=sleep_and_activity, aes(x=TotalMinutesAsleep, y=SedentaryMinutes)) + 
geom_point(color='red') + geom_smooth() +
  labs(title="Total Minutes Asleep vs. Sedentary Behaviour")
plot7 <- ggplot(data=sleep_and_activity, aes(x=TotalMinutesAsleep, y=LightlyActiveMinutes)) + 
geom_point(color='red') + geom_smooth() +
  labs(title="Total Minutes Asleep vs. Light Active Minutes")
plot8 <- ggplot(data=sleep_and_activity, aes(x=TotalMinutesAsleep, y=FairlyActiveMinutes)) + 
geom_point(color='red') + geom_smooth() +
  labs(title="Total Minutes Asleep vs. Fairly Active Minutes")
plot9 <- ggplot(data=sleep_and_activity, aes(x=TotalMinutesAsleep, y=VeryActiveMinutes)) + 
geom_point(color='red') + geom_smooth() +
  labs(title="Total Minutes Asleep vs. Very Active Minutes")
plot_grid(plot6, plot7, plot8, plot9, ncol=2)
```

As shown in the plots there is a direct correlation between activity type and sleep pattern.

* When sedentary minutes increase it negatively affects sleep pattern as shown in the first plot
* When activity types vary from light to fair to very active the sleep pattern also changes 

# STEP 6: ACT

## Conclusion and Recommendations
The business task is to analyze FitBit fitness tracker usage data to gain insight into how consumers are using it and identify trends that can guide the marketing strategy of Bellabeat. As indicated in the various analysis above FitBit fitness tracker has major limitations on the data collected such as demographic data including gender and age which limits the analysis process considerably. 

### Here are some recommendations based on the available data:

* Bellbeat can deploy a marketing strategy around its Bellabeat Leaf device to encourage people to take more steps by reminding them to move. This will help to reduce sedentary behaviour
* Bellbeat can deploy a marketing strategy around including functionality such as floors climbed count which helps to exercise the heart as an extra motivator to improve fitness.
* Bellbeat can deploy a marketing strategy around features such as Recording resting heart rate to indicate the level of fitness and cardiovascular health.
* Bellbeat can deploy a marketing strategy around features such as High and low heart rate notifications. 
* Bellbeat can deploy a marketing strategy around features such as better sleep score which is related to daily activity type.

There are other fitness datasets that can be used to expand the findings of this analysis.

Thank you for reading my first data analysis using R and I would very much appreciate it if you share with me your comment and feedback for further improvement.